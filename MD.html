
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="DataTables_jy.js"></script>
    <link rel="stylesheet" href="dataTables_jy.css">
    <title>Document</title>
    <style>
            td{
                height:25px;
            }
        </style>
</head>
<body>
    
</body>
<script>
var jsonData=[
    {P_Code:"AQ2382",DSNNO:"D#1",Color:"C#1",Cust_Color:"CustColor",BALE:"1",Roll:"1",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#1",Color:"C#1",Cust_Color:"CustColor",BALE:"1",Roll:"2",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#1",Color:"C#1",Cust_Color:"CustColor",BALE:"1",Roll:"3",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#1",Color:"C#1",Cust_Color:"CustColor",BALE:"1",Roll:"4",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#1",Color:"C#1",Cust_Color:"CustColor",BALE:"1",Roll:"5",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#1",Color:"C#2",Cust_Color:"CustColor",BALE:"1",Roll:"6",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#1",Color:"C#2",Cust_Color:"CustColor",BALE:"1",Roll:"7",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#1",Color:"C#2",Cust_Color:"CustColor",BALE:"1",Roll:"8",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#2",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"9",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#2",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"10",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#2",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"11",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#2",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"12",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2382",DSNNO:"D#2",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"13",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2383",DSNNO:"D#1",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"14",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2383",DSNNO:"D#1",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"15",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2383",DSNNO:"D#1",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"16",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2383",DSNNO:"D#1",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"17",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2383",DSNNO:"D#1",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"18",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2383",DSNNO:"D#1",Color:"C#2",Cust_Color:"CustColor",BALE:"2",Roll:"19",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2383",DSNNO:"D#1",Color:"C#2",Cust_Color:"CustColor",BALE:"2",Roll:"20",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2383",DSNNO:"D#1",Color:"C#2",Cust_Color:"CustColor",BALE:"2",Roll:"21",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2383",DSNNO:"D#2",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"22",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
    {P_Code:"AQ2383",DSNNO:"D#2",Color:"C#1",Cust_Color:"CustColor",BALE:"2",Roll:"23",P_Colstd:"zzz",LOTNO:"2",MTS:(Math.random()*100 ).toFixed(2),KGS:(Math.random()*100 ).toFixed(2) },
]
DataTables_jy.setting={
    data:jsonData,
    theadMeaasge: {   //头部信息
        headStr:"P_Code,1,1,,#DSNNO,1,1,,#Color,1,1,,#LOTNO,1,1,,#Roll,1,1,,#MTS,1,1,,#KGS,1,1,,#Roll,1,1,,#MTS,1,1,,#KGS,1,1,,"
    },
    Print:{
        spanCols:["Color","LOTNO"],
        Items:["Color","LOTNO","Roll","MTS","KGS"],
        Width:["50px","50px","50px","50px","50px","50px"],
        
        r_Sum:[
            {title:"CTTLM",sum:"MTS",rl:"Color"},
            {title:"CTTLK",sum:"KGS",rl:"Color"},
            {title:"DTTLM",sum:"MTS",rl:"DSNNO"},
            {title:"DTTLK",sum:"KGS",rl:"DSNNO"}
        ],
        
        // pageBreak:["P_Code"],
        // onet_num:2,
        // allrows:10
        circleRule:{
            maxCount:2,
            margin:10,
            circleItem:["Roll","MTS","KGS"]
            },
        circletd:[
            {
                fatherEle:"LOTNO",
                top:"Roll,1,1,,#MTS,1,1,,#KGS,1,1,,#Roll,1,1,,#MTS,1,1,,#KGS,1,1,,#,1,1,,#,1,1,,",
                bottom:"total,1,6,,#&MTS&,1,1,,#&KGS&,1,1,,"

            }
        ]
    }
}
DataTables_jy.init();
document.body.appendChild(DataTables_jy.CreataPrintTable());
var row={
                maxCount:2,
                margin:3,
                circleItem:["Roll","MTS"]
            }

function reranobjArr(array,sortarray){
    var length=jsonData.length;
    var newArray=[];
    for(var i=0;i<length;i++){
        if(!jsonData[i].hasOwnProperty("zzflag")){
          
        var newObj=deepCloneObj(jsonData[i]);
        for(var data in newObj){
            if(contains(row.circleItem,data)>-1)
            {
                var text=newObj[data];
                var array=[text];
                newObj[data]=array;
            }
        }
        newArray.push(newObj);
        for(var l=1;l<row.maxCount;l++){
            if(i+l*row.margin<length){
                for(var h=0;h<row.circleItem.length;h++){
                    newObj[row.circleItem[h]].push(jsonData[i+l*row.margin][row.circleItem[h]]);

                    jsonData[i+l*row.margin]["zzflag"]="y";

                }
            }else{
                for(var h=0;h<row.circleItem.length;h++){
                    newObj[row.circleItem[h]].push("");

                  
                }
            }

        }
    }
    }
    return newArray;
}




/************对象深克隆***************/
function deepCloneObj(obj){
    var result={},oClass=isClass(obj);
    for(key in obj){
        var copy=obj[key];
        if(isClass(copy)=="Object"){
            result[key]=arguments.callee(copy);
        }else if(isClass(copy)=="Array"){
            result[key]=arguments.callee(copy);
        }else{
            result[key]=obj[key];
        }
    }
    return result;
}
function deepCloneArr(array){
    var result=[];
    for(var i=0;i<array.length;i++)
    {
        if(isClass(array[i])=="Object")  result.push(deepCloneObj(array[i]));
        else result.push(array[i])
    }

}
function isClass(o){
    if(o===null) return "Null";
    if(o===undefined) return "Undefined";
    return Object.prototype.toString.call(o).slice(8,-1);
}
/************对象深克隆***************/

function contains(arr, obj) {
    for (var i = 0; i < arr.length; i++)
    {
        if (arr[i] === obj) {
            
            return i;
        }
    }
    return -1;
}
</script>
</html>
